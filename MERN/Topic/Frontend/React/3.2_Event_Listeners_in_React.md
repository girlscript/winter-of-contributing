![Event-Listeners-in-React](https://miro.medium.com/max/1400/1*a6LO_JY1hzQM8NhKg-7gfA.gif)

<p>&nbsp</p>

<h1 align="center">Using Event Listeners in Components</h1>

## Introduction
You might be acquainted with listening to events in a standard Javascript programme. In a React app, doing the same event listening could be a little more complicated. "Where do I add the event listener?" or "When and how do I cancel an event?" are questions you could have. These questions will be answered in this documentation.

<p>&nbsp</p>

## Adding an *Event Listener*

<p>&nbsp</p>

![Add-event-listener](https://c.tenor.com/ADEbOuubJIUAAAAC/doesnt-add-up-the-hangover.gif)

<p>&nbsp</p>

You can create an event listener in a React app by using the `window.addEventListener` method, just like you would in a vanilla Javascript app:

```js
window.addEventListener('keydown', (event) => {
  // ...
});
```

The line of code above demonstrates how to add a `keydown` event listener to the window. The most difficult aspect of this snippet is deciding where to put it. React is a system built on the concept of components. Because all of your pages are merely components, adding an event listener will have to take place inside of one of them. Here's an example of a component where a `keydown` listener may be useful:

```js
import React from 'react';

const App = (props) => {
  window.addEventListener('keydown', (event) => {
    // ...
  });
  return (
    <div className='container'>
      <h1>Welcome to the Keydown Listening Component</h1>
    </div>
  );
};
```

There are a couple of problems with the code above.

    1. You only want the event listener added when the component finishes rendering.

    2. You need to remove the event listener when the component is unmounted.

To solve the first issue you will need to use the *useEffect* hook. From the `React.useEffect` [documentation](https://reactjs.org/docs/hooks-reference.html#useeffect):

> The function passed to `useEffect` will run after the render is committed to the screen.

```js
const App = (props) => {
  React.useEffect(() => {
    window.addEventListener('keydown', (event) => {
      // ...
    });
  });

  return (
    <div className='container'>
      <h1>Welcome to the Keydown Listening Component</h1>
    </div>
  );
};
```

The `addEventListener` is now called at the proper moment, but there is still a problem: the way it is designed currently, every time a component changes, a new listener is added. This is due to the fact that you must specify the `useEffect` hook to only execute when the component renders for the first time. You may accomplish this by passing an empty dependency array as the second parameter to `useEffect`:

```js
const App = (props) => {
  React.useEffect(() => {
    window.addEventListener('keydown', (event) => {
      // ...
    });
  }, []);

  return (
    <div className='container'>
      <h1>Welcome to the Keydown Listening Component</h1>
    </div>
  );
};
```

When you pass that dependency array to the hook, it informs it to only run the callback function if one of the dependencies changes. The `useEffect` hook will only execute once if you provide it an empty array. Because you don't want to create a duplicate event listener, you'd want this behaviour in this situation.

<p>&nbsp</p>

## Removing an Event Listener

You'll need to know how to delete the event listener if the component is no longer mounted now that you've added it to your component. `window.removeEventListener` is the function for deleting an event listener.

```js
window.removeEventListener('keydown', handlekeyDown);
```

You'll note that the second parameter to `removeEventListener` is a variable rather than an anonymous function. Because you might potentially have several `keydown` event listeners running at the same time, this is required for determining which event listener to delete.

When the component unmounts, all you have to do now is use `removeEventListener`, but how do you accomplish that in a functional component? Although there is no `componentDidUnmount` lifecycle method, the `useEffect` hook provides a callback function with an optional `return` value. When the component unmounts, you can return a function to the `useEffect` callback, and that function will be executed. After successfully deleting an event listener, your code should look like this:

```js
const App = (props) => {
  const handleKeyDown = (event) => {
    console.log('A key was pressed', event.keyCode);
  };

  React.useEffect(() => {
    window.addEventListener('keydown', handleKeyDown);

    // cleanup this component
    return () => {
      window.removeEventListener('keydown', handleKeyDown);
    };
  }, []);

  return (
    <div className='container'>
      <h1>Welcome to the Keydown Listening Component</h1>
    </div>
  );
};
```

---

<p>&nbsp</p>

## External References

- [Handle DOM and Window Events with React](https://www.digitalocean.com/community/tutorials/how-to-handle-dom-and-window-events-with-react)

- [Handling Events](https://reactjs.org/docs/handling-events.html)

- [React components with custom events](https://www.falldowngoboone.com/blog/talk-to-your-react-components-with-custom-events/)