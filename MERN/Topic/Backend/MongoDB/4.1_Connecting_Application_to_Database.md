# Connecting Node.JS application to Mongo Database

## Setting Up
<p>Before beginning let's setup our databse.</p>
<p>Making sure Node.Js is installed in your device, you will need **MongoDB** driver to connect your database and execute the queries.</p>

Install via following command : 
  ```npm install mongodb```

- This will install all the required tools and application in your device and run *npm list* to display all the currently installed driver numbers.

## Creating MongoDB Atlad cluster and load the sample data
- [Go to atlas cluster](https://www.mongodb.com/cloud/atlas) and create a free and new cluster.
- After creation of cluster load all the sample data.

## Getting connect info
- Navigate to cluster and click **Connect**. A wizard will pop-up.
- It will prompt to connect to IP adress to IP Access List and creating user(If not already done).
- Don't forget to write username and password as this helps later on while performing several operations.
- Select **Connect your application**. Select **Node.Js**, then copy the provided connection string.
- Click [here](https://docs.atlas.mongodb.com/connect-to-cluster) for more information on clusters.

## Connecting Node.jd application to Mongo
 # Import Mongo Client
 - The MongoDB module exports MongoClient, and that’s what we’ll use to connect to a MongoDB database.
 - Import MongoClient :   
     ```const {MongoClient} = require('mongodb');```
 - Create asynchronous function named *main()* which will connect MongoDB cluster, call function that will query our database and be further used to disconnect it : 
       ```async function main() {
	// code
  }``` 
 - The first thing we need to do inside of main() is create a constant for our connection URI. The connection URI is the connection string you copied in Atlas in the previous section. When you paste the connection string, don't forget to update <username> and <password> to be the credentials for the user you created in the previous section. 
 - Your connection URI will be something like this : 
  ```const uri = "mongodb+srv://<username>:<password>@<your-cluster-url>/test?retryWrites=true&w=majority";```
 - Create instance :
  ```const client = new MongoClient(uri);```
 - When you run this code, you may see DeprecationWarnings around the URL string parserand the Server Discover and Monitoring engine. If you see these warnings, you can remove them by passing options to the MongoClient. For example, you could instantiate MongoClient by calling : 
  ```new MongoClient(uri, { useNewUrlParser: true, useUnifiedTopology: true })```
 - Return the clusture promise to *client.connect()* for that we will use await : 
  ```await client.connect();```
 - Build a function that prints the names of the databases in this cluster.This is just an example of naming convention according to logic : 
  ```await listDatabases(client);```
 - To handle any unexpected error we will be using *try/catch* blocks :
    ```try { await client.connect(); await listDatabases(client); } catch (e) { console.error(e); }```
	
 - Closing connection with finally statement :
  ```finally { await client.close(); }```
 - Putting everything together we get :   
   ```async function main(){ const uri = "mongodb+srv://<username>:<password>@<your-cluster-url>/test?retryWrites=true&w=majority"; const client = new MongoClient(uri); try{ await client.connect(); await  listDatabases(client); } catch (e) { console.error(e); } finally { await client.close(); } } main().catch(console.error);```

  <hr>
  - If you need a video tutorial head over [here](https://www.youtube.com/watch?v=fbYExfeFsI0) to get connection steps from official MongoDB youtube channel.
